<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Gliko â€” Trendovi</title>
  <link rel="icon" href="icon-192.png" type="image/png"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="../css/style.css"/>
</head>
<body>

  <!-- Uputstvo modal koji se otvara automatski pri uÄitavanju -->
  <div id="instructionModal" class="modal" hidden>
    <div class="modal-content">
      <div class="modal-head">
        <h3>DobrodoÅ¡li u Gliko aplikaciju</h3>
        <button class="close" id="instructionClose">âœ•</button>
      </div>
      <div class="modal-body">
        <p>Ovde moÅ¾ete pratiti trendove vaÅ¡ih merenja nivoa Å¡eÄ‡era, dobiti savete za ishranu i kontrolisati terapiju.</p>
        <ul>
          <li><strong>U odgovarajuÄ‡a polja unestite:</strong></li>
          <li>Vrednost Å¡eÄ‡era</li>
          <li>Datum i vreme merenja</li>
          <li>Izaberite komentar o aktivnosti koja je prethodila merenju</li>
          <li>MoÅ¾ete uneti i vrstu hrane koju ste konzumirali da biste pratili uticaj toga Å¡ta jedete na vrednost Å¡eÄ‡era</li>
          <li><strong>AI "asistent" Ä‡e uporediti vaÅ¡e trenutno merenje sa referentnim vrednostima.</strong></li>
          <li><strong>Ako imate viÅ¡e merenja, odmah Ä‡ete videti njihov prosek vrednosti.</strong></li>
          <li><strong>Pritiskom na taster "ANALIZA TRENDOVA" AI "asistent" Ä‡e uporediti sva vaÅ¡a merenja sa referentnim vrednostima i na njih dati komentar (uzmite u obzir da ovo nije medicinski savet).</strong></li>
          <li><strong>U grafikonu i tabeli ispod moÅ¾ete videti sve vaÅ¡e merene vrednosti koje moÅ¾ete filtrirati po dobu dana. (i grafikon i tabela se aÅ¾uriraju na osnovu filtera)</strong></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Unos podataka za glukozu -->
  <div class="card form-card">
    <h3>Unesi vrednost Å¡eÄ‡era</h3>
    <div class="grid3">
      <div>
        <label>Datum</label>
        <input type="date" id="date">
      </div>
      <div>
        <label>Vreme</label>
        <input type="time" id="time">
      </div>
      <div>
        <label>Glukoza (mmol/L)</label>
        <input type="number" id="glucose" step="0.1" placeholder="npr. 5.8">
      </div>
    </div>
    <div class="mt8">
      <label>Komentar</label>
      <select id="comment">
        <option value="PRE DORUÄŒKA">PRE DORUÄŒKA</option>
        <option value="1.5 - 2 SATA NAKON DORUÄŒKA">1.5 - 2 SATA NAKON DORUÄŒKA</option>
        <option value="PRE RUÄŒKA">PRE RUÄŒKA</option>
        <option value="1.5 - 2 SATA NAKON RUÄŒKA">1.5 - 2 SATA NAKON RUÄŒKA</option>
        <option value="PRE VEÄŒERE">PRE VEÄŒERE</option>
        <option value="1.5 - 2 SATA NAKON VEÄŒERE">1.5 - 2 SATA NAKON VEÄŒERE</option>
        <option value="PRE SPAVANJA">PRE SPAVANJA</option>
        <option value="NAKON FIZIÄŒKE AKTIVNOSTI">NAKON FIZIÄŒKE AKTIVNOSTI</option>
      </select>
    </div>

    <!-- Emoji â€” 2 reda -->
    <div class="emoji-wrap">
      <div class="emoji-row">
        <label><input type="checkbox" value="ğŸ¥š"> ğŸ¥š</label>
        <label><input type="checkbox" value="ğŸŸ"> ğŸŸ</label>
        <label><input type="checkbox" value="ğŸ—"> ğŸ—</label>
        <label><input type="checkbox" value="ğŸ¥©"> ğŸ¥©</label>
        <label><input type="checkbox" value="ğŸ¥—"> ğŸ¥—</label>
      </div>
      <div class="emoji-row">
        <label><input type="checkbox" value="ğŸ"> ğŸ</label>
        <label><input type="checkbox" value="ğŸ°"> ğŸ°</label>
        <label><input type="checkbox" value="â˜•"> â˜•</label>
        <label><input type="checkbox" value="ğŸ¥¤"> ğŸ¥¤</label>
        <label><input type="checkbox" value="ğŸ¥ƒ"> ğŸ¥ƒ</label>
        <label><input type="checkbox" value="ğŸ·"> ğŸ·</label>
      </div>
    </div>

    <div class="actions">
      <button class="primary" id="btnAdd">â• Dodaj unos</button>
      <input type="file" id="fileInput" class="file">
      <button id="btnImport">ğŸ“¥ Import CSV</button>
      <button id="btnExport">ğŸ“¤ Export CSV</button>
      <button class="ghost" id="btnClear">ğŸ§¹ ObriÅ¡i sve</button>
    </div>
  </div>

  <!-- Stat kartice -->
  <div class="stats">
    <div class="stat prosek">
      <div class="label">Prosek</div>
      <div class="value" id="statAvg">â€”</div>
    </div>
    <div class="stat min">
      <div class="label">Min</div>
      <div class="value" id="statMin">â€”</div>
    </div>
    <div class="stat max">
      <div class="label">Maks</div>
      <div class="value" id="statMax">â€”</div>
    </div>

    <!-- Premestio dugme za AI analizu ispod statistike -->
    <div class="ai-block">
      <button class="ai-btn full-width" id="btnAnalyzeTable">ANALIZA TRENDOVA</button>
      <small class="muted">Ovo nije medicinski savet.</small>
    </div>
  </div>

  <!-- Filteri po zoni + period -->
  <div class="card">
    <h3>Filteri po dobu dana</h3>
    <div class="chip-row">
      <button class="chip" data-zone="jutro">ğŸŒ„ Jutro (06â€“09)</button>
      <button class="chip" data-zone="prepodne">ğŸŒ¤ï¸ Pre podne (09â€“12)</button>
      <button class="chip" data-zone="popodne">â˜€ï¸ Popodne (12â€“17)</button>
      <button class="chip" data-zone="vece">ğŸŒ‡ VeÄe (17â€“22)</button>
      <button class="chip" data-zone="noc">ğŸŒ™ NoÄ‡ (22â€“06)</button>
      <button class="chip ghost" data-zone="">ğŸ”„ PrikaÅ¾i sve</button>
    </div>

    <div class="date-range">
      <div>
        <label>PoÄetak</label>
        <input type="date" id="startDate">
      </div>
      <div>
        <label>Kraj</label>
        <input type="date" id="endDate">
      </div>
      <button id="btnApplyRange">âœ… Primeni period</button>
      <button id="btnResetRange" class="ghost">ğŸ”„ PoniÅ¡ti</button>
    </div>
  </div>

  <!-- Grafik -->
  <div class="card">
    <h4>Trend po filterima</h4>
    <canvas id="glucoseChart" height="120"></canvas>
  </div>

  <!-- Tabela -->
  <div class="card">
    <h4>VaÅ¡e vrednosti u poslednje vreme</h4>
    <table class="table" id="logTable">
      <thead>
        <tr><th>Datum</th><th>Vreme</th><th>Glukoza</th><th>Komentar</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- AI modal -->
  <div id="aiModal" class="modal" hidden>
    <div class="modal-content">
      <div class="modal-head">
        <h3>AI ANALIZA TRENDA</h3>
        <button class="close" id="aiClose">âœ•</button>
      </div>
      <div id="aiBody" class="modal-body"></div>
    </div>
  </div>

  <!-- Skripte -->
  <script src="trends.js"></script>
  <script src="ai_current.js"></script> <!-- Za trenutnu vrednost -->
  <script src="ai_analysis.js"></script> <!-- Za analizu cele tabele -->

  <!-- Automatski otvori modal uputstva pri uÄitavanju -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Automatski otvori uputstvo modal
      const instructionModal = document.getElementById('instructionModal');
      instructionModal.hidden = false;

      // Dodajemo funkcionalnost za zatvaranje modala
      document.getElementById('instructionClose').addEventListener('click', function() {
        instructionModal.hidden = true;
      });
    });
  </script>
</body>
</html>
